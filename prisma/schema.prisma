// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
  schemas  = ["cash-compass"]
}

model Profile {
  id         String   @id @default(uuid()) @db.Uuid
  email      String?  @db.Text
  created_at DateTime @default(now()) @db.Timestamptz(6)
  updated_at DateTime @default(now()) @updatedAt @db.Timestamptz(6)

  // Relations
  budget_categories BudgetCategory[]
  expenses         Expense[]
  user_settings    UserSettings?

  @@map("profiles")
  @@schema("cash-compass")
}

model BudgetCategory {
  id            String   @id @default(uuid()) @db.Uuid
  name          String   @db.Text
  color         String   @default("#3B82F6") @db.Text
  budget_amount Decimal  @default(0) @db.Decimal(10, 2)
  user_id       String   @db.Uuid
  created_at    DateTime @default(now()) @db.Timestamptz(6)
  updated_at    DateTime @default(now()) @updatedAt @db.Timestamptz(6)

  // Relations
  user    Profile   @relation(fields: [user_id], references: [id], onDelete: Cascade)
  expenses Expense[]

  @@map("budget_categories")
  @@schema("cash-compass")
}

model Expense {
  id          String   @id @default(uuid()) @db.Uuid
  amount      Decimal  @db.Decimal(10, 2)
  description String?  @db.Text
  category_id String   @db.Uuid
  user_id     String   @db.Uuid
  created_at  DateTime @default(now()) @db.Timestamptz(6)

  // Relations
  category BudgetCategory @relation(fields: [category_id], references: [id], onDelete: Cascade)
  user     Profile        @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@map("expenses")
  @@schema("cash-compass")
}

model UserSettings {
  id             String   @id @default(uuid()) @db.Uuid
  user_id        String   @unique @db.Uuid
  monthly_income Decimal  @default(0) @db.Decimal(10, 2)
  created_at     DateTime @default(now()) @db.Timestamptz(6)
  updated_at     DateTime @default(now()) @updatedAt @db.Timestamptz(6)

  // Relations
  user Profile @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@map("user_settings")
  @@schema("cash-compass")
}